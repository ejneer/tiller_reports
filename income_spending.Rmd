---
output: html_document
---
<!--
Comment block
-->
```{r}
weekly_income <- weekly_cash_flow %>%
  select(Week, Income)

net_weekly <- weekly_cash_flow %>%
  select(Net)

income_spending_chart <- weekly_cash_flow %>%
  filter(Week %in% breaks$Week) %>%
  select(Week, `Weekly Income` = Income, `Weekly Spending` = Spending) %>%
  mutate(`Weekly Spending` = -`Weekly Spending`) %>%
  pivot_longer(
    c(`Weekly Spending`, `Weekly Income`),
    names_to = "Cash Flow Group",
    values_to = "Amount"
  ) %>%
  ggplot() +
  geom_col( 
    aes(x = Week, y = Amount, fill = `Cash Flow Group`),
    position = "dodge2",
    width = 3
  ) +
  scale_x_date(
    labels = scales::date_format("%b %d"),
    breaks = breaks$Week
  ) +
  theme(
    legend.title = element_blank(), 
    legend.position="top"
  ) + 
  labs(x ="Week (By Sunday)", y = "Amount")

ggplotly(income_spending_chart + theme)
```

